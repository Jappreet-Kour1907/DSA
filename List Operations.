#include<stdio.h>
#define MAX 100 // stores maximum size
int list[MAX]; //global declaration
int n = 0;
void insertinbeginning(int value){ // cases: list is empty,non-empty(full)
    if(n >= MAX){
        printf("List is Full!!!\n");
        return;
    }
    for( int i = n-1; i>=0; i--){   // traverse the array in reverse order and shift elements towards right side
    list[i+1] = list[i];
    }
    list[0] = value;
    n++;
    printf("Element Inserted In Beginning !!\n");
}
void insertatend(int value){
    if(n == MAX){
        printf("List is Full\n");
        return;
    }
    list[n++] = value;
    printf("Element Inserted!!\n");
}
void insertatposition(int pos, int value){
    if(n == MAX){
        printf("List is Full !!!\n");
    }
    else if(pos < 0 || pos>=n)
        printf("Invalid position!!!\n");
    else {
        for(int i=n-1; i>=pos; i--){
            list[i+1] = list[i];     // right shifting
        }
        list[pos] = value;
        n++;
        printf("Elemented Inserted!!!\n");
    }

}
void deletefrombeg(){
    if(n == 0){
        printf("List is Empty !!!\n");
        return;
    }
    else {
        for(int i=0; i<n; i++){
            list[i]=list[i+1];    // left shifting
        }
        n--;
        printf("Element Deleted!!!\n");
    }
}
void deletefromend(){
     if(n == 0){
        printf("List is Empty !!!\n");
        return;
    }
    n--;
    printf("Element Deleted!!!\n");
}
void deleteatposition(int pos){
    if(n == 0){
        printf("List is Empty !!!\n");
        return;
    }
    else if (pos<0 || pos>=n){
        printf("Invalid Position!!!\n");
    }
    else{
        for(int i=pos; i<n; i++){
            list[i]=list[i+1];
        }
        n--;
        printf("Element Deleted!!!\n");
    }
}
int searchelement(int value){ // linear search
    for(int i=0; i<n; i++){
        if(list[i] == value)
        return i;
    }
    return -1;
}
void bubblesort(){
    for(int i=0; i<n-1; i++){
        for(int j=0; j<n-1; j++){
            if(list[j] > list[j+1]){
                int temp = list[j];
                list[j] = list[j+1];
                list[j+1] = temp;
        }
    }
  }
  printf("Element Sorted !!!\n");
}
void updatelist(int pos, int value){
    if(n == 0){
        printf("List is Empty !!!\n");
        return;
    }
    else if (pos<0 || pos>=n){
        printf("Invalid Position!!!\n");
    }
    else{
        list[pos]=value;
        printf("Element Updated!!!\n");
    }

}

void displaylist(){
    if(n == 0){
        printf("List is Empty !!\n");
        return;
    }
    for(int i=0; i<n; i++){
        printf("%d\t", list[i]);
    }
    printf("\n");
}
int main (){
    while(1){
        printf("1.Insert in Beginning\n");
        printf("2.Insert At End\n");
        printf("3.Insert at Specified Position\n");
        printf("4.Delete from Beginning\n");
        printf("5.Delete from End\n");
        printf("6.Delete from Specified Position\n");
        printf("7.Display List\n");
        printf("8.Search Element In List\n");
        printf("9.Update list Element\n");
        printf("10.Sort Element of List\n");
        printf("11.Exit\n");
        int choice, data, pos;
        printf("Enter Choice:");
        scanf("%d", &choice);
        switch(choice){
            case 1:
                printf("Enter data:");
                scanf("%d", &data);
                insertinbeginning(data);
                break;
            case 2:
                printf("Enter data:");
                scanf("%d", &data);
                insertatend(data);
                break;
            case 3:
                printf("Enter position:");
                scanf("%d", &pos);
                scanf("%d", &data);
                insertatposition(pos, data);
                break;
            case 4:
                deletefrombeg();
                break;
            case 5:
                deletefromend();
                break;
            case 6:
                printf("Enter position:");
                scanf("%d", &pos);
                deleteatposition(pos);
                break;
            case 7:
                displaylist();
                break;
            case 8:
                printf("Enter searching Element:");
                scanf("%d",&data);
                int index = searchelement(data);
                if(index != -1)
                    printf("Element found at index %d\n", index);
                else
                    printf("Element not Found!!!\n");
                break;
            case 9:
                printf("Enter position:");
                scanf("%d", &pos);
                printf("Enter New Data:");
                scanf("%d",&data);
                updatelist(pos, data);
                break;
            case 10:
                bubblesort();
                break;
            default:
                printf("Invalid Choice!!!\n");
        }
    }
    return 0;
}
